#!/usr/bin/env bash

if [[ $# -eq 1 ]]; then
  selected=$1
else
  # apps=$(find ~/apps -mindepth 2 -maxdepth 2 -type d)
  apps=$(find ~/code -mindepth 1 -maxdepth 1 -type d)
  configs=$(find ~/.config -mindepth 1 -maxdepth 1 -type l)
  selected=$(
    echo -e "$apps\n$configs" | cut -d '/' -f 4- | fzf-tmux -p 90% \
      --color 'pointer:10,spinner:92,marker:46,bg+:-1' \
      --prompt "Ôê¢  " \
      --exit-0 \
      --preview 'eza $HOME/{} --color always --icons -l --group-directories-first --no-user --no-time --no-filesize --no-permissions'
  )
fi

if [[ -z $selected ]]; then
  exit 0
fi

selected_name=$(basename "$selected" | tr . _)

tconnect "$HOME/$selected" $selected_name
